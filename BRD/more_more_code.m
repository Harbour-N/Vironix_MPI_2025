function b = nbhd()
     b = ones(150,150);
%{
    b = [ 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0 0 0 0 0 0 0;
          0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0;
          0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0;
          0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0;
          0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0;
          0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0;
          0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0;
          1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
          1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
          1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
          1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
          1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
          0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0;
          0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0;
          0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0;
          0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0;
          0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0;
          0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0;
          0 0 0 0 0 0 0 1 1 1 1 1 1 1 0 0 0 0 0 0 0;
          ];
%}
end

disp('begin')

load("bird_data\birds.mat");

b = squeeze(bird_matrix(1,:,:));
b(isnan(b)) = 0;
b = b/sum(b,'all');

y = 400;
x = 1200;

s = size(nbhd);
dy = (s(1)-1)/2;
dx = (s(2)-1)/2;

xn = b(y-dy:y+dy,x-dx:x+dx).*nbhd();
p = sum(xn,'all')/sum(nbhd(),'all');

b(y-dy:y+dy,x-dx:x+dx) = b(y-dy:y+dy,x-dx:x+dx) - nbhd().*b(y-dy:y+dy,x-dx:x+dx);


figure(1)
imagesc(b);
colormap gray;
daspect([1 1 1]);


disp('end')